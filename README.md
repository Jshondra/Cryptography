# Cryptography
# EX1
Задания по лабораторной работе №1
Задание 1. Написать программу, реализующую шифр замены. 
Требования к программе:
В начале работы программы пользователь выбирает тип операции: шифрование или расшифрование.
Программа позволяет зашифровывать и расшифровывать текст на 
русском языке, записанный в текстовом файле в стандартной кодировке ОС Windows.
Зашифрованный текст сохраняется в отдельном текстовом файле.
Таблица замены (ключ шифрования) генерируется случайным образом и сохраняется в файле key.txt.
Расшифрование файла производится на основе таблицы, которая 
считывается из файла key.txt.
Расшифрованный текст сохраняется в отдельном файле.
Задание 2. Расшифровать текст, выданный преподавателем, с 
помощью частотного криптоанализа (т.е. при отсутствии ключа 
шифрования). Текст получен путём замены букв и пробелов по некоторой (заранее неизвестной) таблице. Остальные символы (знаки 
препинания, цифры) остаются неизменными.
В результате работы должна быть получена частотная таблица
выданного шифротекста, а на её основе подобрана таблица замены.
Частотная таблица находится с помощью вспомогательной программы

# EX2 
Задание 1. Написать программу, реализующую генератор 
M-последовательности на основе полинома обратной связи, выданного преподавателем. Начальные значения битов регистра сдвига задаются случайным образом (с помощью стандартного генератора случайных чисел). В программе 
должна быть возможность сохранять начальное состояние регистра сдвига в 
файле key.txt, а также возможность загружать начальное состояние регистра из 
этого же файла. Предусмотреть возможность вывода первых n двоичных элементов М-последовательности на экран (n задаётся пользователем).
Примечание. Предварительно проверить правильность работы алгоритма 
для полинома P(x) = x4+ x1+ 1 (см. Рис. 2).
Задание 2. Протестировать М-последовательность длиной N бит
(N ≤ 10000, задаётся преподавателем) с помощью сериального теста. Использовать серии длиной 2, 3 или 4 бита (по указанию преподавателя). Найти 
2по 
формуле (3) и проверить выполнение неравенства (5) для заданного уровня значимости α.
При тестировании (Задание 2, 3) необходимо учесть тот факт, что первые L
битов M-последовательности совпадают с начальным состоянием регистра 
сдвига и не зависят от функции обратной связи. Если начальные разряды реги-17
стра недостаточно «случайны», результаты тестов могут быть искажены. Чтобы 
этого избежать, первые 2L тактов регистр должен работать в «холостом режиме», то есть первые 2L битов не участвуют в тестировании.
Задание 3. Протестировать М-последовательность с помощью корреляционного теста. Найти значение Rk по формуле (6) для k = 1, 2, 8, 9. Проверить 
выполнение неравенства (8).
Задание 4. Реализовать программу шифрования/расшифрования двоичного
файла с помощью М-последовательности. В качестве ключа использовать 
начальное значение регистра сдвига, которое хранится в файле key.txt. Результат шифрования сохранить в файле encoded.txt. Расшифровать файл encoded.txt
с помощью того же ключа и убедиться, что расшифрованный и исходный файлы идентичны. Шифрование и расшифрование осуществляется по формуле (1) 
путём сложения по модулю два (операция «исключающее ИЛИ») двоичного 
представления шифруемого файла с М-последовательностью.
Задание 5. Протестировать исходный и зашифрованный файлы с помощью 
статистических тестов (Задание 2, 3). Объяснить результаты тестов.

# EX3
Задание 1. Программно реализовать процедуру генерации открытого и 
закрытого ключей заданной длины L (128, 256, 512). В качестве открытой экспоненты использовать одно из чисел Ферма (17, 257, 65537). Сформированные 
ключи сохранить в файлы: открытый – в файл public.txt, а закрытый – в файл 
private.txt.
Задание 2. Программно реализовать процедуры шифрования и дешифрования согласно алгоритму RSA. Использовать открытый и закрытый ключи, 
сформированные в Задании 1.
На вход программы подается текстовая строка S длиной не более L/8 символов. Каждому символу строки сопоставляется 8-битный двоичный код согласно таблице кодировки ASCII. Биты всех символов последовательно объединяются в одно большое двоичное число M, которое подвергается шифрованию и расшифрованию. Например, исходная строка S = 'abc' преобразуется в 
24-битное число M = 01100001’01100010’01100011. В результате шифрования
ключом public.txt образуется двоичное число C, которое записывается в файл 
encrypted.txt.
На втором этапе полученное ранее число C считывается из файла 
encrypted.txt и расшифровывается с помощью закрытого ключа private.txt. Полученное число M' преобразуется в символьную строку S', которая записывается в выходной файл decrypted.txt. При правильной реализации процедур шиф-26
рования/расшифрования исходная S и расшифрованная S' строки должны совпасть.
Задание 3. Проверить работоспособность алгоритма RSA в случае, когда 
одно из чисел p и q не является простым.
Задание 4. Написать программу, реализующую атаку на алгоритм RSA 
(вычисление закрытого ключа по известному открытому ключу) с использованием ρ-эвристики Полларда. Результатом работы программы должно быть разложение заданного числа n на два простых множителя p и q.
Провести атаку для различных длин ключа. Убедиться, что с ростом битовой длины ключа (т. е. числа n= p⋅q) растет время его факторизации. Построить график зависимости этого времени от длины ключа (пока время работы 
программы не превысит нескольких минут). Для этого последовательно увеличивать длину p и q, начиная с 30 бит с шагом в 2 бита. Когда время расчетов 
превысит 10 секунд, уменьшить шаг до 1 бита.
Задание 5. Выяснить, как влияет различие битовой длины чисел p и q на 
сложность факторизации. Для этого берется максимальная длина ключа, 
найденная в Задании 4, которую обозначим буквой L. Затем генерируются простые числа p и q, имеющие длину rL и (1–r)L соответственно (r < 1). Построить 
график зависимости времени факторизации числа n = p⋅q от r для r = 0,25 … 0,5 
с шагом 0,05.
